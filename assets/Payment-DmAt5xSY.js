import{d as M,r as f,p as S,o as q,E as r,H as N,i as I,e as o,w as l,z as P,b as t,F as A,J as F,A as O,B as T,C as U,k as d,a4 as J,a6 as L,y as R,v as b,a1 as Y,m as g,c as z,N as D,_ as H}from"./index-W1bgIC_N.js";/* empty css                  *//* empty css                  *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        */import{a as $}from"./order-Bi6y7mAK.js";/* empty css                       *//* empty css                   */import"./request-C-7Hg0qh.js";const j={class:"payment-container"},G={class:"goods-section"},K={class:"goods-content"},Q={class:"goods-info"},W={class:"goods-title"},X={class:"goods-price"},Z={class:"total"},ee={class:"form-section"},te={class:"total-section"},se={class:"total-amount"},oe={class:"form-section"},ae={class:"action-buttons"},le=M({__name:"Payment",setup(ne){const c=N,u=f([]),v=f(),a=f({name:"",phone:"",address:"",paymentMethod:"ALIPAY"}),V={name:[{required:!0,message:"请输入收货人姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1\d{10}$/,message:"手机号格式不正确",trigger:"blur"}],address:[{required:!0,message:"请输入收货地址",trigger:"blur"}]},E=S(()=>u.value.reduce((n,e)=>n+e.price*e.quantity,0)),p=n=>n.toFixed(2),x=()=>{c.push("/cart")},w=async()=>{try{await v.value.validate(),await Y.confirm("确认生成订单吗？","订单确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const e={itemIds:JSON.parse(sessionStorage.getItem("selectedCartItemIds")||"[]"),recipient:{name:a.value.name,telephone:a.value.phone,location:a.value.address},method:a.value.paymentMethod};sessionStorage.removeItem("selectedCartItemIds");const i=await $(e);i.data.code==="200"?(r.success("订单创建成功"),c.push("/order")):r.error(i.data.msg)}catch{r.error("创建失败")}};return q(()=>{const n=sessionStorage.getItem("selectedItems");if(sessionStorage.removeItem("selectedItems"),n)try{u.value=JSON.parse(n)}catch{r.error("商品信息解析失败"),c.push("/cart")}else r.warning("请先选择商品"),c.push("/cart")}),(n,e)=>{const i=D,h=P,_=U,m=T,B=O,C=L,k=J,y=R;return g(),I("div",j,[o(h,{class:"payment-card"},{default:l(()=>[e[10]||(e[10]=t("h1",{class:"title"},"订单结算",-1)),t("div",G,[e[4]||(e[4]=t("h2",{class:"section-title"},"商品信息",-1)),(g(!0),I(A,null,F(u.value,s=>(g(),z(h,{key:s.productId,class:"goods-item"},{default:l(()=>[t("div",K,[o(i,{src:s.cover,class:"goods-image",fit:"cover"},null,8,["src"]),t("div",Q,[t("h3",W,d(s.title),1),t("div",X,[t("span",null,"单价：¥"+d(p(s.price)),1),t("span",null,"数量："+d(s.quantity),1),t("span",Z,"小计：¥"+d(p(s.price*s.quantity)),1)])])])]),_:2},1024))),128))]),t("div",ee,[e[5]||(e[5]=t("h2",{class:"section-title"},"收货信息",-1)),o(B,{ref_key:"formRef",ref:v,model:a.value,rules:V,"label-width":"100px"},{default:l(()=>[o(m,{label:"收货人姓名",prop:"name"},{default:l(()=>[o(_,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.name=s),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),o(m,{label:"手机号码",prop:"phone"},{default:l(()=>[o(_,{modelValue:a.value.phone,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.phone=s),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),o(m,{label:"收货地址",prop:"address"},{default:l(()=>[o(_,{modelValue:a.value.address,"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.address=s),type:"textarea",rows:3,placeholder:"请输入详细收货地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),t("div",te,[e[6]||(e[6]=t("span",{class:"total-label"},"订单总额：",-1)),t("span",se,"¥"+d(p(E.value)),1)]),t("div",oe,[e[7]||(e[7]=t("h2",{class:"section-title"},"支付方式",-1)),o(m,{label:"选择支付方式",prop:"paymentMethod"},{default:l(()=>[o(k,{modelValue:a.value.paymentMethod,"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.paymentMethod=s),placeholder:"请选择支付方式"},{default:l(()=>[o(C,{label:"支付宝",value:"ALIPAY"})]),_:1},8,["modelValue"])]),_:1})]),t("div",ae,[o(y,{class:"cancel-button",onClick:x},{default:l(()=>e[8]||(e[8]=[b("取消")])),_:1}),o(y,{class:"pay-button",onClick:w},{default:l(()=>e[9]||(e[9]=[b("生成订单")])),_:1})])]),_:1})])}}}),he=H(le,[["__scopeId","data-v-5fcc7a11"]]);export{he as default};

import{d as R,r as m,p as T,o as z,i as b,b as i,K as H,L as K,c as V,w as o,E as r,z as X,V as j,e as l,B as G,C as J,a2 as O,g as P,u as Q,a3 as S,v as u,N as W,y as Y,A as Z,U as $,a1 as ee,ad as te,m as c,_ as ae}from"./index-CcEL__uZ.js";/* empty css                   *//* empty css                  *//* empty css                 *//* empty css                     *//* empty css                    *//* empty css                        *//* empty css                 */import{g as le,d as oe,u as ne}from"./advertisement-DEPwoR5p.js";import{u as se}from"./tool-C-2oWe-p.js";import"./request-BuipQ3Vl.js";const de={class:"update-page"},re={class:"update-container"},ue={key:0},ie={class:"el-upload__text"},pe={class:"button-group"},me=R({__name:"UpdateAdvertisement",setup(ce){const w=j(),f=te(),x=async()=>{if(t.value)try{await ee.confirm("确定要永久删除该广告吗？此操作不可恢复！","警告",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}),(await oe(t.value.id)).data.code==="200"&&(r.success("广告删除成功"),f.push("/all"))}catch(a){a!=="cancel"&&r.error("删除失败")}},g=m([]),t=m(null),y=m(!0),v=m([]),E=()=>{const a=w.params.id;t.value=g.value.find(e=>e.id===a)||null},U=async()=>{try{const a=await le();a.data.code==="200"&&(g.value=a.data.data,E())}catch{r.error("获取广告数据失败")}finally{y.value=!1}},I=T(()=>{var a,e,n,d,p;return((e=(a=t.value)==null?void 0:a.title)==null?void 0:e.trim())&&((d=(n=t.value)==null?void 0:n.content)==null?void 0:d.trim())&&((p=t.value)==null?void 0:p.imgUrl)}),B=async()=>{if(t.value)try{(await ne({id:t.value.id,title:t.value.title,content:t.value.content,imgUrl:t.value.imgUrl,productId:t.value.productId})).data.code==="200"&&(r.success("广告更新成功"),f.push("/all"))}catch{r.error("更新失败")}},k=a=>{v.value=[a],new FormData().append("file",a.raw),se().then(n=>{t.value&&(t.value.imgUrl=n.data.result)})},A=()=>{r.warning("只能上传一张图片")},C=()=>new XMLHttpRequest,D=()=>{f.go(-1)};return z(()=>{U()}),(a,e)=>{const n=J,d=G,p=P,q=W,L=O,_=Y,h=Z,F=$,M=X,N=K;return c(),b("div",de,[i("div",re,[H((c(),V(M,{class:"form-card"},{default:o(()=>[t.value?(c(),b("div",ue,[e[12]||(e[12]=i("h1",null,"更新广告",-1)),l(h,{"label-position":"right","label-width":"100px",size:"large",class:"update-form"},{default:o(()=>[l(d,{label:"广告ID"},{default:o(()=>[l(n,{modelValue:t.value.id,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value.id=s),disabled:""},null,8,["modelValue"])]),_:1}),l(d,{label:"广告标题",required:""},{default:o(()=>[l(n,{modelValue:t.value.title,"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.title=s),placeholder:"请输入广告标题"},null,8,["modelValue"])]),_:1}),l(d,{label:"广告内容",required:""},{default:o(()=>[l(n,{modelValue:t.value.content,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.content=s),placeholder:"请输入广告内容",type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),l(d,{label:"关联产品ID",required:""},{default:o(()=>[l(n,{modelValue:t.value.productId,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.productId=s),placeholder:"请输入关联产品ID",disabled:""},null,8,["modelValue"])]),_:1}),l(d,{label:"广告图片",required:""},{default:o(()=>[l(L,{"file-list":v.value,"onUpdate:fileList":e[4]||(e[4]=s=>v.value=s),limit:1,"on-change":k,"on-exceed":A,class:"upload-demo","list-type":"picture","http-request":C,drag:""},{default:o(()=>[l(p,{class:"el-icon--upload"},{default:o(()=>[l(Q(S))]),_:1}),i("div",ie,[e[5]||(e[5]=u(" 当前图片： ")),l(q,{src:t.value.imgUrl,style:{width:"100px","margin-right":"10px"}},null,8,["src"]),e[6]||(e[6]=u(" 将新图片拖到此处或")),e[7]||(e[7]=i("em",null,"单击此处",-1)),e[8]||(e[8]=u("上传 "))])]),_:1},8,["file-list"])]),_:1}),i("span",pe,[l(_,{type:"primary",onClick:B,disabled:!I.value},{default:o(()=>e[9]||(e[9]=[u(" 提交更新 ")])),_:1},8,["disabled"]),l(_,{type:"danger",onClick:x},{default:o(()=>e[10]||(e[10]=[u(" 删除广告 ")])),_:1}),l(_,{onClick:D},{default:o(()=>e[11]||(e[11]=[u("返回")])),_:1})])]),_:1})])):(c(),V(F,{key:1,description:"广告不存在"}))]),_:1})),[[N,y.value]])])])}}}),Ie=ae(me,[["__scopeId","data-v-babb1d31"]]);export{Ie as default};
